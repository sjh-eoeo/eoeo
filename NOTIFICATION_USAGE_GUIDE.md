# 알림 시스템 동작 가이드

## 📋 알림 타입별 동작

### 1. 📧 프로젝트 초대 알림
**특징:**
- 누가: Admin이 프로젝트에 참여자로 추가할 때
- 우선순위: 긴급 (빨간색)
- 링크: `/negotiation/notifications` (알림 페이지)

**동작:**
```
1. 헤더의 🔔 벨 아이콘 클릭
2. 드롭다운에서 📧 초대 알림 클릭
3. → 알림 페이지로 이동
4. 알림 페이지에서 초대 알림 클릭
5. → 읽음 처리 (페이지 이동 없음)
```

**이유:**
- 일반 유저는 Admin 페이지에 접근할 수 없음
- 초대 확인만 하면 되므로 별도 페이지 이동 불필요
- 알림 페이지에서 모든 초대를 한 눈에 확인 가능

---

### 2. 💬 새 댓글 알림
**특징:**
- 누가: 프로젝트에 새 댓글이 달릴 때
- 우선순위: 중요 (노란색)
- 링크: 프로젝트 상태에 따른 페이지

**동작:**
```
1. 헤더의 🔔 벨 아이콘 클릭
2. 드롭다운에서 💬 댓글 알림 클릭
3. → 해당 프로젝트 페이지로 이동
   (예: /negotiation/negotiating, /negotiation/draft-review 등)
```

---

### 3. 📹 Draft 제출 알림
**특징:**
- 누가: 크리에이터가 Draft를 제출할 때
- 우선순위: 중요 (노란색)
- 링크: `/negotiation/draft-review`

**동작:**
```
1. 헤더의 🔔 벨 아이콘 클릭
2. 드롭다운에서 📹 Draft 알림 클릭
3. → Draft Review 페이지로 이동
```

---

### 4. 🚨 업데이트 필요 알림
**특징:**
- 누가: 48시간 이상 업데이트가 없을 때 자동 생성
- 우선순위: 긴급 (빨간색)
- 링크: 프로젝트 상태에 따른 페이지

**동작:**
```
1. 헤더의 🔔 벨 아이콘 클릭
2. 드롭다운에서 🚨 긴급 알림 클릭
3. → 해당 프로젝트 페이지로 이동
```

---

## 🎯 사용 시나리오

### 시나리오 1: 프로젝트 초대받음
```
1. Admin이 "Nike Campaign" 프로젝트에 참여자로 추가
2. junhoi90@gmail.com 계정으로 로그인
3. Negotiation 선택
4. 헤더 우측 🔔 아이콘에 빨간 숫자 "1" 표시
5. 클릭 → 드롭다운 열림
6. "📧 프로젝트 초대" 알림 보임
   - "Admin님이 'Nike Campaign' 프로젝트에 초대했습니다"
7. 알림 클릭 → 알림 페이지로 이동
8. 알림 페이지에서 다시 클릭 → 읽음 처리 (파란 점 사라짐)
9. 프로젝트 작업 시작!
```

### 시나리오 2: 새 댓글 알림
```
1. 누군가 "Nike Campaign" 프로젝트에 댓글 작성
2. 🔔 아이콘에 숫자 증가
3. 클릭 → 드롭다운
4. "💬 새 댓글" 알림 클릭
5. → 해당 프로젝트 페이지로 바로 이동
6. 댓글 확인 및 답변
```

### 시나리오 3: Draft 제출 알림
```
1. 크리에이터가 Draft v2 제출
2. 🔔 아이콘에 숫자 증가
3. 클릭 → 드롭다운
4. "📹 Draft 제출" 알림 클릭
5. → Draft Review 페이지로 이동
6. 비디오 검토 및 승인/거절
```

---

## 🔄 알림 페이지 사용법

### 접근 방법:
1. 헤더 🔔 → "모두 보기" 클릭
2. 또는 직접 `/negotiation/notifications` 접속

### 필터 기능:
- **전체**: 모든 알림
- **읽지 않음**: 미확인 알림만
- **초대**: 프로젝트 초대만
- **업데이트**: 댓글, Draft 등

### 날짜별 그룹:
- 오늘
- 어제
- 이번 주
- 이전

### 동작:
| 알림 타입 | 클릭 시 동작 |
|---|---|
| 📧 초대 | 읽음 처리 (현재 페이지 유지) |
| 💬 댓글 | 프로젝트 페이지로 이동 |
| 📹 Draft | Draft Review 페이지로 이동 |
| 🚨 긴급 | 프로젝트 페이지로 이동 |

---

## 💡 팁

### 초대 알림 확인:
```
✅ DO: 알림 페이지에서 클릭 → 읽음 처리
❌ DON'T: Admin 페이지로 가려고 하지 말 것 (일반 유저는 접근 불가)
```

### 여러 알림 처리:
```
1. 알림 페이지 접속
2. "모두 읽음으로 표시" 클릭
3. 또는 하나씩 클릭해서 확인
```

### 실시간 업데이트:
```
- 알림 페이지: 5초마다 자동 새로고침
- 드롭다운: 열 때마다 자동 새로고침
- 수동 새로고침: 페이지 새로고침 (Cmd+R)
```

---

## 📊 알림 우선순위

### 긴급 (빨간색):
- 🚨 48시간 이상 업데이트 없음
- 📧 프로젝트 초대

### 중요 (노란색):
- 💬 새 댓글
- 📹 Draft 제출

### 일반 (회색):
- 기타 업데이트

---

## 🎨 UI 요소

### 헤더 벨 아이콘:
```
🔔     → 알림 없음
🔔 [1]  → 1개 알림 (빨간 뱃지)
🔔 [9+] → 9개 이상 (9+로 표시)
```

### 알림 표시:
```
📧 [파란 점] 프로젝트 초대    → 읽지 않음
📧          프로젝트 초대    → 읽음

💬 [파란 점] 새 댓글         → 읽지 않음
💬          새 댓글         → 읽음
```

---

## ⚙️ 권한별 차이

### Admin:
- 모든 프로젝트 알림 확인
- 모든 초대 알림 확인
- Admin 페이지 접근 가능

### 일반 User:
- 참여 중인 프로젝트 알림만 확인
- 자신에게 온 초대 알림만 확인
- Admin 페이지 접근 불가 (초대 알림은 알림 페이지에서만 확인)

---

## 🔧 문제 해결

### 초대 알림이 안 보임:
1. Negotiation 프로젝트 선택 확인
2. 페이지 새로고침 (Cmd+R)
3. 콘솔 확인:
   ```
   🔍 Filtering invitations for: [your-email]
   📊 Found X invitations
   ```
4. LocalStorage 확인:
   ```javascript
   JSON.parse(localStorage.getItem('project-invitations'))
   ```

### 알림을 클릭해도 반응 없음:
- 초대 알림: 정상 (읽음 처리만, 페이지 이동 없음)
- 다른 알림: 브라우저 콘솔 확인

### 알림 개수가 안 맞음:
1. 페이지 새로고침
2. 알림 페이지에서 "모두 읽음으로 표시"
3. LocalStorage 초기화 (테스트):
   ```javascript
   localStorage.removeItem('project-invitations');
   ```

---

## 📝 요약

| 알림 타입 | 아이콘 | 우선순위 | 클릭 시 | 읽음 처리 |
|---|---|---|---|---|
| 프로젝트 초대 | 📧 | 긴급 | 알림 페이지 | 클릭 시 |
| 새 댓글 | 💬 | 중요 | 프로젝트 페이지 | 자동 |
| Draft 제출 | 📹 | 중요 | Draft Review | 자동 |
| 업데이트 필요 | 🚨 | 긴급 | 프로젝트 페이지 | 자동 |

**핵심:**
- 📧 초대 알림 → 알림 페이지에서만 확인 (일반 유저 접근성)
- 💬📹🚨 다른 알림 → 해당 페이지로 바로 이동 (빠른 액션)
